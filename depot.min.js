/* ----------------------------------
 * depot.js v0.1.0
 * Licensed under The MIT License
 * http://opensource.org/licenses/MIT
 * ---------------------------------- */
(function(b,e,a){"object"===typeof exports?module.exports=a():"function"===typeof define&&define.amd?define(a):e[b]=a()})("depot",this,function(){function b(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}var e={save:function(a){a.id||(a.id=b()+b()+"-"+b()+"-"+b()+"-"+b()+"-"+b()+b()+b());0>this.ids.indexOf(a.id)&&(this.ids.push(a.id),localStorage.setItem(this.name,this.ids.join(",")));localStorage.setItem(this.name+"-"+a.id,JSON.stringify(a));return a},updateAll:function(a){this.all().forEach(function(d){for(var c in a)a.hasOwnProperty(c)&&
(d[c]=a[c]);this.save(d)},this)},find:function(a){var d,c,b,e=this.name;return this.ids.reduce(function(f,g){if(b=localStorage.getItem(e+"-"+g)){b=b&&JSON.parse(b);c=!0;if(a)for(d in a)c&=a[d]==b[d];c&&f.push(b)}return f},[])},get:function(a){return(a=localStorage.getItem(this.name+"-"+a))&&JSON.parse(a)},all:function(){var a,d=this.name;return this.ids.reduce(function(b,e){(a=localStorage.getItem(d+"-"+e))&&b.push(a&&JSON.parse(a));return b},[])},destroy:function(a){var b;b=a.id?a.id:a;localStorage.removeItem(this.name+
"-"+b);b=this.ids.indexOf(b);-1!=b&&this.ids.splice(b,1);localStorage.setItem(this.name,this.ids.join(","));return a},destroyAll:function(){this.ids.forEach(function(a){localStorage.removeItem(this.name+"-"+a)},this);localStorage.removeItem(this.name);this.ids=[]}};return function(a){var b,c;if(!localStorage)throw Error("localStorage not found");c=(b=localStorage.getItem(a))&&b.split(",")||[];return Object.create(e,{name:{value:a},store:{value:b},ids:{value:c,writable:!0}})}});
